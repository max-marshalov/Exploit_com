from django.shortcuts import render
from django.shortcuts import redirect
from django.shortcuts import get_object_or_404
from django.http import HttpResponse
from .models import Article
from .models import Category
from .models import User
from django.views.generic import View
from .utils import ObjectDetailMixin
from django.views.generic.edit import CreateView
from .forms import SignUpForm
from django.urls import reverse_lazy
"""def posts_list(request):
    articles = Article.objects.all()
    return render(request, 'mainPage/mainPage.html', context={'arts':articles})
 """
class ArticleDetail(View):
     def get(self, request, id):
          #article = Article.objects.get(id=id)
          article = get_object_or_404(Article, id=id)
          return render(request, 'mainPage/art_detail.html', context={'art':article})

class UsrCreateView(View):
     def get(self, request):
          form = SignUpForm()
          return render(request, 'mainPage/signup.html', context={'form':form})
     def post(self, request):
          bound_form = SignUpForm(request.POST)
          if bound_form.is_valid():
               new_user = bound_form.save()
               return redirect('index')
          return render(request, 'mainPage/signup.html', context={'form':bound_form})



def by_cat(request, cat_id):
     article = Article.objects.filter(category=cat_id)
     categories = Category.objects.all()
     current_cat = get_object_or_404(Category, pk=cat_id)
     context = {'arts': article, 'cats' : categories, 'current_cat' : current_cat}
     return render(request, 'mainPage/mainPage.html', context)

def index(request):
     arts = Article.objects.all()
     cats = Category.objects.all()
     context = {'arts' : arts, 'cats' : cats}
     return render(request, 'mainPage/mainPage.html', context)

"""def article_detail(request, id):
     article = Article.objects.get(id=id)
     return render(request, 'mainPage/art_detail.html', context={'art':article})
"""